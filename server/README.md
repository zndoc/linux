# Сервер

## Virtual Box

Сделать проброс портов:

Имя | Протокол | Адрес хоста | Порт хоста | Адрес гостя | Порт гостя
--- | --- | --- | --- | --- | ---
Rule1 | TCP |  | 2222 | 10.0.2.15 | 22
Rule2 | TCP |  | 8080 | 10.0.2.15 | 80

Запустить сервер VirtualBox.

Подключиться к серверу:

    ssh user@localhost -p 2222

## Доступ к sudo

Чтобы иметь возможность выполнять задачи администратора в сессии нового пользователя, передайте ему права суперпользователя. Для этого нужно открыть ему доступ к использованию команды sudo.

    usermod -aG sudo userName

Теперь новый пользователь имеет права суперпользователя.

## Аутентификация на основе ключей

Рекомендуется защитить нового пользователя, настроив аутентификацию на основе ключей.

### Генерирование ключей

Если у вас ещё нет пары SSH-ключей, сгенерируйте их. Если у вас уже есть открытый и закрытый ключ, переходите к разделу «Копирование ключей».

Чтобы сгенерировать новую пару ключей, введите в терминал на локальной машине (то есть на компьютере) следующую команду:

    ssh-keygen

Команда создаст закрытый ключ (id_rsa) и открытый ключ (id_rsa.pub) в каталоге .ssh в домашнем каталоге пользователя localuser.

> Важно! Закрытый ключ нельзя разглашать.

### Установка ключа вручную

Чтобы добавить ключ вручную, введите следующую команду в терминал локальной машины:

    cat ~/.ssh/id_rsa.pub

Команда выведет на экран открытый ключ.

Скопируйте ключ в буфер обмена.

Чтобы разрешить использование ключа SSH для аутентификации нового удаленного пользователя, нужно добавить открытый ключ в специальный файл в домашнем каталоге этого пользователя.

Создайте новый каталог .ssh и ограничьте доступ к нему:

    mkdir ~/.ssh
    chmod 700 ~/.ssh

Откройте файл authorized_keys в каталоге .ssh:

    nano ~/.ssh/authorized_keys

Вставьте в него открытый ключ. Нажмите CTRL-x, y и Enter, чтобы закрыть и сохранить файл.

Заблокируйте доступ к файлу authorized_keys:

    chmod 600 ~/.ssh/authorized_keys

